<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>自由配置型食品認知マップ研究</title>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div id="app" class="screen-container">
        <div id="screen1" class="screen">
            <h2>被験者情報を入力してください</h2>
            <input id="subjectName" type="text" placeholder="お名前" required autocomplete="name">
            <input id="subjectAge" type="number" placeholder="年齢" min="18" max="99" required autocomplete="age">
            <input id="subjectEmail" type="email" placeholder="メールアドレス" required autocomplete="email">
            <button id="goToScreen2Btn">次へ</button>
            <p class="info-text">※入力された情報は、研究目的以外には使用されません。</p>
        </div>

        <div id="screen2" class="screen">
<h2>実験のやり方・注意事項</h2>
            <div style="text-align: left; width: 100%; max-width: 800px; margin: 0 auto;">
                <h4>ステップ1：食品の配置</h4>
                <p>まず、画面上に表示される食品画像を、あなたの感覚に従って自由に配置します。<br>
                <strong>操作方法:</strong> 食品の上にある<strong>青いバー</strong>をドラッグ＆ドロップして動かします。「似ている」と感じる食品は近くに、「似ていない」と感じる食品は遠くに置いてみてください。</p>
                <ul>
                    <li>例1：「餃子」と「チャーハン」は中華料理だから近くに置く。</li>
                    <li>例2：自分が<strong>好きな食べ物</strong>（グラタン、ラザニアなど）を画面の右側に集める。</li>
                    <li>例3：<strong>よく知らない食べ物</strong>（エンパナーダなど）を画面の左下に固めて置く。</li>
                </ul>
                <p>食品の<strong>丸い[i]ボタン</strong>を押すと詳細情報を確認できます。配置が終わったら「<strong>配置を確定する</strong>」ボタンを押してください。</p>

                <h4>ステップ2：クラスター（グループ）の作成</h4>
                <p>次に、配置した食品をグループ分けします。<br>
                <strong>操作方法:</strong> 関連性が高いと思う食品を<strong>3つ以上</strong>まとめて、マウスでぐるっと円で囲んでください。円を描き終えると名前を尋ねられるので、あなたが考えたグループ名を入力します。</p>
                <ul>
                    <li>例1：「餃子」「チャーハン」「から揚げ」を囲んで「<strong>がっつり系の中華</strong>」と名付ける。</li>
                    <li>例2：「冷凍うどん」「冷凍パスタ」などを囲んで「<strong>手軽なお昼ごはん</strong>」と名付ける。</li>
                </ul>
                <p>作成したクラスターは、円をクリックすると削除も可能です。グループ分けが終わったら「<strong>クラスターレビューへ進む</strong>」ボタンを押してください。</p>

                <h4>ステップ3：フィードバックの記入</h4>
                <p>最後に、作成した各グループについて、なぜそのように分けたのかを記述します。<br>
                <strong>操作方法:</strong> 画面右側に表示される質問フォームに、作成したグループごとに回答を入力します。全ての項目を記入したら「<strong>全てのフィードバックを記入しデータ保存</strong>」ボタンを押して終了です。</p>
            </div>
            <p style="margin-top: 20px;">準備ができたら下のボタンを押して実験を開始してください。</p>
            <button id="startExperimentBtn">実験開始</button>
            <button id="backToScreen1Btn" class="back-button">前の画面に戻る</button>
        </div>

        <div id="screen3" class="screen">
            <h1>自由配置型食品認知マップ</h1>
            <div class="experiment-layout-container">
                <div class="canvas-area">
                    <div id="canvas-container">
                        <canvas id="clusterCanvas"></canvas>
                    </div>
                </div>
                <div id="details-panel" class="details-area">
                    <h3 id="details-food-name"></h3>
                    <img id="details-food-image" src="" alt="選択された食品の画像" style="display:none;">
                    <div id="details-food-info"></div>
                    <p id="details-placeholder" class="info-text" style="display:block;">食品の[i]ボタンをクリックすると、ここに詳細情報が表示されます。</p>
                </div>
            </div>
            <div class="button-controls">
                <button id="backToScreen2Btn" class="back-button">前の画面に戻る</button> 
                <button id="finishPlacementBtn">配置を確定する</button>
                <button id="goToFeedbackBtn" style="display:none;">クラスターレビューへ進む</button>
                <button id="saveFeedbackAndDataBtn" style="display:none;">全てのフィードバックを記入しデータ保存</button>
            </div>
            <div class="spinner" id="loadingSpinner"></div>
            <p class="info-text" id="statusMessage"></p>
        </div>

        <div id="screen4" class="screen">
            <h2>実験にご協力いただきありがとうございました！</h2>
            <p>データの保存が完了しました。ご協力ありがとうございました。</p>
            <p class="info-text">この画面を閉じていただいて結構です。</p>
            <button id="backToStartBtn" class="back-button">最初の画面に戻る</button> 
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>
